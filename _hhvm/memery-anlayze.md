##	引言

内存泄露对于c和c++来说比较普遍，而旧的php引擎来说由于是多进程的模式，而且会定期清理一部分进程，所以即使有内存泄露也不是很明显或者关注不多;

Hhvm是单进程多线程模型，对于稳定性要求就极高，如果其中出现了内存泄露，那么会很明显，而且目前hhvm使用人群还不多，对于分析hhvm内存的方法还了解不多，我下面就介绍一些hhvm会出现的内存泄露情况和一些分析的方法。

##	内存泄露分析方法
对于hhvm有时候的内存增长是正常的，有些确实泄露，那么我们如何很好的判断呢？
一般可分为正常的内存增长和异常增长（泄露）：
### 正常内存增长：
增长非线性的，到达一定条件后会稳定或者释放

1. 线程局部变量(持久化对象,随线程增加而增加)
1. APC
1. 更新文件（jit cache、opcode cache）

### 异常内存增长：

每次请求都会线性增长内存，并且不会释放；

1.	某个语法或者函数引起的内存泄露
	1. define动态值
	1. create_function
	1. eval动态值

1.  引擎内部泄露
  1. libevent长连接未释放 (1.0时泄露，之后fix)
  1. ini 泄露( hhvm 2.2,2.3后fix)
1.  扩展内存泄露

通过上面的方式可以初步分析出一些情况，是否是内存泄露，如果怀疑是内存泄露后，那么我们就可以通过如下3种方式进行定位：

###	排除法

###	Jemalloc
###	Valgrand
